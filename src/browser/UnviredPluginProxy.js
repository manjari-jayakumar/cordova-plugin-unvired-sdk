cordova.define("cordova-plugin-unvired-sdk.UnviredPluginProxy",function(e,t,a){var r,u="/UMP/API/v2/applications/",s="/session/",c="/execute/",o="/UMP/API/v2/users/",p={sMeta:[],fMeta:[],bMeta:[]},i="UNVIRED_ID",l="ADS",d="SAP",f="EMAIL",m="RQST",g="PULL",v=0,n=1,b=0,h=1;a.exports.login=function(e,t,a){if(console.log("Unvired Plugin Login Options:"+JSON.stringify(a)),(r=a[0]).hasOwnProperty("persistWebDb")&&!1!==r.persistWebDb||y.clearLokiDbs(),I.initialize(),e){var n={type:0};e(n)}},a.exports.logout=function(e,t,a){y.clearLokiDbs()},a.exports.getListOfFrontEndUsers=function(t,e,a){if(y.validateLoginParameters(v,t)){M.appMeta={},M.appMeta.appName=r.appName,M.appMeta.url=r.url,M.appMeta.authorization="Basic "+window.btoa(r.company+"\\"+r.username+":"+r.password);var n=M.appMeta.url+o+r.username;M.performRequest(n,"",function(e){t(e)},M.httpType.get,!1)}},a.exports.authenticateAndActivate=function(n,e){if(y.validateLoginParameters(v,n)){var o;switch(M.appMeta={},M.appMeta.frontEnd=r.feUserId,M.appMeta.appName=r.appName,M.appMeta.url=r.url,M.appMeta.username=r.username,r.loginType){case f:case i:M.appMeta.authorization="Basic "+window.btoa(r.company+"\\"+r.username+":"+r.password),o=M.appMeta.url+u+M.appMeta.appName+s;break;case d:M.appMeta.authorization="Basic "+window.btoa(r.company+"\\"+r.username),o=M.appMeta.url+s+"applications/"+M.appMeta.appName,M.appMeta.credentials=JSON.stringify([{port:r.domain,user:r.username,password:r.password}]);break;case l:M.appMeta.authorization="Basic "+window.btoa(r.company+"\\"+r.username),o=M.appMeta.url+s+"applications/"+M.appMeta.appName,M.appMeta.credentials=JSON.stringify([{port:r.port,user:r.domain+"\\"+r.username,password:r.password}])}M.performRequest(o,"",function(e){if(e.type==b){M.appMeta.authorization="Bearer:"+e.data.token,o=M.appMeta.url+s+e.data.sessionId,M.appMeta.credentials="",A.initialize(),A.saveAppMeta(M.appMeta),(t={type:2}).data=e,n(t)}else{var t,a="";y.isEmpty(e)||(a=y.isEmpty(e.error)?"No error description returned from server":JSON.parse(e.error).error),(t={type:3}).error=a,n(t)}},M.httpType.post,!1,r.jwtOptions)}},a.exports.authenticateLocal=function(e,t,a){y.validateLoginParameters(n,e)&&alert("Api not supported on Web!")},a.exports.getAllAccount=function(e,t,a){alert("Api not supported on Web!")},a.exports.switchAccount=function(e,t,a){a.account;alert("Api not supported on Web!")},a.exports.deleteAccount=function(e,t,a){alert("Api not supported on Web!")},a.exports.submitInSync=function(t,e,a){console.log("OPTIONS: "+JSON.stringify(a,null,2));var n,o,r,s,p;n=a[0].requestType,o=a[0].header,r=a[0].customData,s=a[0].paFunction,p=a[0].autoSave,A.appDb.loadDatabase({}),M.appMeta.url&&""!==M.appMeta.url||(M.appMeta=A.getAppMeta());var i=M.appMeta.url+u+M.appMeta.appName+c+s;console.log("End Point: "+i);var l="";null!==o&&""!==o||(l=r),l=M.removeLokiMeta(l),M.performRequest(i,l,function(e){return e.type==b&&p&&(e=N.parseServerResponse(JSON.parse(e.data),n)),t(e)},M.httpType.post,!1)},a.exports.submitInASync=function(t,e,a){var n,o,r;reqype=a[0].requestType,n=a[0].header,o=a[0].customData,r=a[0].paFunction,autosave=a[0].autoSave,A.appDb.loadDatabase({}),M.appMeta.url&&""!==M.appMeta.url||(M.appMeta=A.getAppMeta());var s=M.appMeta.url+u+M.appMeta.appName+c+r,p="";null!==n&&""!==n||(p=o),p=M.removeLokiMeta(p),M.performRequest(s,p,function(e){return t(e)},M.httpType.post,!0)},a.exports.getMessages=function(e,t,a){alert("Api not supported on Web!")},a.exports.registerNotifListener=function(e,t,a){alert("'registerNotifListener' - Api not supported on Web! Web supports only sync call")},a.exports.unRegisterNotifListener=function(e,t,a){alert("'unRegisterNotifListener' - Api not supported on Web! Web supports only sync call")},a.exports.generateUBJson=function(e,t,a){var n,o,r,s;n=a[0].headerName,o=a[0].header,r=a[0].itemName,s=a[0].items;var p=y.getBeName(n),i={},l={};l[n]=o,l[r]=s,i[p]=[l],y.sendSuccess("",e,i)},a.exports.parseRawUBJson=function(e,t,a){var n;n=a[0].json;var o=JSON.parse(n),r={infoMessage:[],be:[]},s=[];for(var p in o)if(o.hasOwnProperty(p))if("InfoMessage"===p){var i=o[p];r.infoMessage=i}else{o[p].forEach(function(e){var t={header:"",items:[]};for(var a in e)if(e.hasOwnProperty(a)){var n=e[a];n.constructor===Array?n.forEach(function(e){t.items.push(e)}):n.constructor===Object&&(t.header=n)}s.push(t)})}r.be=s,e(r)},a.exports.select=function(e,t,a){var n,o;n=a[0].tableName,o=a[0].whereClause,A.appDb.loadDatabase({});var r=A.select(n,o);return y.sendSuccess("",e,r)},a.exports.insert=function(e,t,a){var n,o,r;return n=a[0].tableName,r=a[0].isHeader,o=a[0].fields,r||y.isEmpty(o.FID)&&y.sendError("Invalid FID",e),A.insert(n,o,!1),y.sendSuccess("",e,"")},a.exports.insertOrUpdate=function(e,t,a){var n,o,r;return n=a[0].tableName,r=a[0].isHeader,o=a[0].fields,r||y.isEmpty(o.FID)&&y.sendError("Invalid FID",e),A.insert(n,o,!1),y.sendSuccess("",e,"")},a.exports.deleteRecord=function(e,t,a){var n,o;n=a.tableName,o=a.whereClause;var r=A.select(n,o);null!=r&&0<r.length&&r.forEach(function(e){A.deleteCascade(n,e)}),y.sendSuccess("Record deleted successfully",e)},a.exports.update=function(e,t,a){var n,o,r;n=a[0].tableName,r=a[0].whereClause,o=a[0].fields;var s=A.appDb.getCollection(n);if(null!==s){var p=s.find({$and:[r]});null!==p?(p.forEach(function(n){Object.keys(o).forEach(function(e,t){var a=o[e];n[e]=a,s.update(n)})}),A.appDb.saveDatabase(),y.sendSuccess(p.length+" Record updated",e)):y.sendSuccess("No records found",e)}else y.sendError("Table"+n+" not found!",e)},a.exports.executeQuery=function(e,t,a){a[0].query,alert("Api not supported on web!. Use select api instead.")},a.exports.dbGetCollection=function(e,t,a){var n;n=a.tableName,e(A.appDb.getCollection(n))},a.exports.createSavePoint=function(e,t,a){alert("Api not supported on web!.")},a.exports.releaseSavePoint=function(e,t,a){alert("Api not supported on web!.")},a.exports.rollbackSavePoint=function(e,t,a){alert("Api not supported on web!.")},a.exports.beginTransaction=function(e,t,a){alert("Api not supported on web!.")},a.exports.endTransaction=function(e,t,a){alert("Api not supported on web!.")},a.exports.launchFile=function(e,t,a){alert("Api not supported on web!.")},a.exports.unzip=function(e,t,a){alert("Api not supported on web!.")},a.exports.launchBase64=function(e,t,a){alert("Api not supported on web!.")},a.exports.dbReload=function(e,t,a){A.reload(),M.appMeta.url&&""!==M.appMeta.url||(M.appMeta=A.getAppMeta()),I.initialize()},a.exports.getAttachmentFolderPath=function(e,t,a){console.log("ump.attachment.getAttachmentFolderPath - Api not supported in browser!")},a.exports.createAttachmentItem=function(e,t,a){console.log("ump.attachment.createAttachmentItem - Api not supported in browser!")},a.exports.uploadAttachment=function(e,t,a){alert("ump.attachment.createAttachmentItem - Api not supported yet in browser!")},a.exports.downloadAttachment=function(e,t,a){alert("ump.attachment.downloadAttachment - Api not supported yet in browser!")},a.exports.getInfoMessages=function(e,t,a){var n;a[0].headerName,n=a[0].LID;var o=y.getInfoMessages(n);y.sendSuccess("",sucessCallback,o)},a.exports.showSettings=function(e,t,a){alert("Api not supported on Web!")},a.exports.userSettings=function(e,t,a){var n=A.getAppMeta();return n.USER_ID=n.username,r.loginType==LoginType.email&&(n.EMAIL=n.username),y.sendSuccess("",e,n)},a.exports.updateSystemCredentials=function(e,t,a){alert("Api not supported on web!.")},a.exports.getSystemCredentials=function(e,t,a){alert("Api not supported on web!.")},a.exports.getVersionNumbers=function(e,t,a){alert("Api not implemented on Web!")},a.exports.clearData=function(e,t,a){y.clearLokiDbs()},a.exports.reCreateAppDB=function(e,t,a){A.reCreateAppDb(),y.sendSuccess("",sucessCallback,!0)},a.exports.pullDb=function(e,t,a){alert("Api not supported on Web!")},a.exports.pushDb=function(e,t,a){alert("Api not supported on Web!")},a.exports.encrypt=function(e,t,a){alert("Api not supported on Web!")},a.exports.getAppMeta=function(e,t,a){e(A.getAppMeta())},a.exports.guid=function(e,t,a){e(y.guid())},a.exports.hasInternet=function(e,t,a){y.sendSuccess("",e,!0)},a.exports.logError=function(e,t,a){var n,o,r;n=a[0].srcClass,o=a[0].srcMethod,r=a[0].message,console.log("ERROR | "+n+" | "+o+" | "+r)},a.exports.logDebug=function(e,t,a){var n,o,r;n=a[0].srcClass,o=a[0].srcMethod,r=a[0].message,console.log("DEBUG | "+n+" | "+o+" | "+r)},a.exports.logInfo=function(e,t,a){var n,o,r;n=a[0].srcClass,o=a[0].srcMethod,r=a[0].message,console.log("IMPORTANT | "+n+" | "+o+" | "+r)},a.exports.getLogs=function(e,t,a){console.log("Api not supported on Web!")},a.exports.deleteLogs=function(e,t,a){console.log("Api not supported on Web!")},a.exports.sendViaServer=function(e,t,a){console.log("Api not supported on Web!")},a.exports.sendViaEmail=function(e,t,a){console.log("Api not supported in Web!")};var y=(D.getBeName=function(t){return p.sMeta.filter(function(e){return e.name===t})[0].beName},D.getBeHeaderName=function(t){var a="";return p.sMeta.forEach(function(e){e.beName===t&&!0===e.isheader&&(a=e.name)}),a},D.getBeChildrenNames=function(t){var a=p.sMeta.filter(function(e){return e.name===t});return a=p.sMeta.filter(function(e){return e.beName===a[0].beName&&!1===e.isheader})},D.getBeTableNames=function(t){return p.sMeta.filter(function(e){return e.beName===t})},D.saveInfoMessage=function(e,t,a){var n=A.appDb.getCollection("InfoMessage");null===n&&(n=A.appDb.addCollection("InfoMessage")),e.beName=t,e.beLid=a,n.insert(e),A.appDb.saveDatabase()},D.getInfoMessages=function(e){if(null==A.appDb.getCollection("InfoMessage"))return[];var t=A.select("InfoMessage",JSON.stringify({beLid:e}),!0);return null==t?[]:t},D.isEmpty=function(e){return null==e||null===e||""===e},D.copyProperty=function(e,t){for(var a in e)t[a]=e[a];return t},D.validateLoginParameters=function(e,t){if(D.isEmpty(r.appName))return D.sendError("Please provide Application Name!",t),!1;if(D.isEmpty(r.loginType))return D.sendError("Incorrect Login Type!",t),!1;if((r.loginType===d||r.loginType===l)&&!r.domain)return D.sendError("Please provide Domain!",t),!1;if(D.isEmpty(e))return D.sendError("Please set Login Mode!",t),!1;var a=void 0;switch(e){case v:if(D.isEmpty(r.url)?a="Please provide Url!":D.isEmpty(r.company)?a="Please provide Company Name!":D.isEmpty(r.username)?a="Please provide User Id!":D.isEmpty(r.password)&&(a="Please provide Password!"),a)return D.sendError(a,t),!1;break;case n:if(D.isEmpty(r.username)?a="Please provide User Id!":D.isEmpty(r.password)&&(a="Please provide Password!"),a)return D.sendError(a,t),!1}return!0},D.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1).toUpperCase()}return e()+e()+"-"+e()+"-"+e()},D.clearLokiDbs=function(){window.indexedDB.deleteDatabase("LokiCatalog"),localStorage.removeItem("FW_LOKI_DB"),A.appDb=null,A.fwDb=null},D.sendError=function(e,t){var a={};a.type=h,a.error=e,t(a)},D.sendSuccess=function(e,t,a){var n={};n.type=b,n.error=e,n.data=a,t(n)},D);function D(){}var M=(x.performRequest=function(e,t,a,n,o,r){var s={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded",Authorization:x.appMeta.authorization},p={frontendUser:x.appMeta.frontEnd,messageFormat:"standard",inputMessage:JSON.stringify(t),externalReference:y.guid(),queuedExecute:o,jwtOptions:JSON.stringify(r),credentials:x.appMeta.credentials},i=n||"POST";$.ajax({type:i,url:e,data:p,success:function(e){x.hanldeRestApiCallback(!0,e,a)},error:function(e){x.hanldeRestApiCallback(!1,e,a)},headers:s,dataType:"json"})},x.hanldeRestApiCallback=function(e,t,a){var n={};e?(n.type=b,n.message=t&&t.message?t.message:"",n.data=t):(n.type=h,n.error=t&&t.responseText?t.responseText:"",n.message=t&&t.message?t.message:""),a(n)},x.removeLokiMeta=function(e){return""!=e&&(e=JSON.parse(JSON.stringify(e))),function e(t){for(var a in t)t[a]&&"object"==typeof t[a]&&(delete t.$loki,delete t.meta,e(t[a]))}(e),e},x.appMeta={},x.httpType={get:"GET",post:"POST",del:"DELETE"},x);function x(){}var A=(E.initialize=function(){var e=y.isEmpty(r.appName)?"APP_LOKI_DB":r.appName;if(null==E.appDb){var t=new LokiIndexedAdapter;(E.appDb=new loki(e,{adapter:t,autoload:!0,throttledSaves:!1})).loadDatabase({},function(e){console.log(e)})}null==E.fwDb&&(E.fwDb=new loki("FW_LOKI_DB",{env:"BROWSER"})).loadDatabase({})},E.reload=function(){var e=y.isEmpty(r.appName)?"APP_LOKI_DB":r.appName;if(null==E.appDb){var t=new LokiIndexedAdapter;(E.appDb=new loki(e,{adapter:t,autoload:!0,throttledSaves:!1})).loadDatabase({},function(e){console.log(e)})}null==E.fwDb&&(E.fwDb=new loki("FW_LOKI_DB",{env:"BROWSER"})).loadDatabase(JSON.parse(localStorage.FW_LOKI_DB))},E.insert=function(e,t,a){var n=a?E.fwDb:E.appDb,o=n.getCollection(e);null==o&&(o=n.addCollection(e));var r=null;a||(r=E.getBasedOnGid(e,t)),null==r?(y.isEmpty(t.LID)&&(t.LID=y.guid()),o.insert(t)):(t=y.copyProperty(t,r),o.update(t)),n.saveDatabase()},E.select=function(e,t,a){var n=(a?E.fwDb:E.appDb).getCollection(e);return null===n?[]:y.isEmpty(t)?n.data:n.findObjects(t)},E.deleteCascade=function(e,t,a){var n=a?E.fwDb:E.appDb,o=E.getBasedOnGid(e,t);if(o&&null!=o){var r=y.getBeChildrenNames(e);if(null!=r&&0<r.length)for(var s=0;s<r.length;s++){var p=n.getCollection(r[s].name);null!=p&&p.removeWhere({FID:o.LID})}var i=n.getCollection(e);null!=i&&i.removeWhere({LID:o.LID})}n.saveDatabase()},E.getCollection=function(e){return E.appDb.getCollection(name)},E.saveAppMeta=function(e){E.insert("appMeta",e,!0)},E.getAppMeta=function(){var e=E.select("appMeta","",!0);return null!=e&&0<e.length?e[0]:null},E.getBasedOnGid=function(t,a){if(y.isEmpty(t))return null;var e=p.fMeta.filter(function(e){return e.sName===t&&!0===e.isGid});if(null==e||e.length<=0)return null;var n={};e.forEach(function(e){n[e.name]=a[e.name]});var o=E.appDb.getCollection(t);return null===o?null:o.findObject(n)},E.reCreateAppDb=function(){var e=y.isEmpty(r.appName)?"APP_LOKI_DB":r.appName;localStorage.removeItem("APP_LOKI_DB"),localStorage.removeItem(r.appName);var t=new LokiIndexedAdapter;(E.appDb=new loki(e,{adapter:t,throttledSaves:!1})).loadDatabase({}),E.appDb.saveDatabase()},E.appDb=null,E.fwDb=null,E);function E(){}var N=(w.parseServerResponse=function(e,t){var a={};for(var n in a.type=b,a.data=e,a.message="",e.hasOwnProperty("InfoMessage")&&e.InfoMessage.forEach(function(e){y.saveInfoMessage(e),a.message=a.message+" "+e.message,"FAILURE"===e.category&&(a.type=h)}),e)if("InfoMessage"!==n){var o=e[n];if(t==g){var r=y.getBeTableNames(n);if(null!=r&&0<r.length)for(var s=0;s<r.length;s++){var p=A.appDb.getCollection(r[s].name);null!=p&&p.clear()}}o.forEach(function(e){w.handleEachBE(e,t,n)})}return A.appDb.saveDatabase(),a},w.handleEachBE=function(e,t,a){var n="",o=!1;for(var r in e)if(e.hasOwnProperty(r)){var s=e[r];if(s.constructor===Array)s.forEach(function(e){e.FID=n;var t=A.getBasedOnGid(r,e),a=A.appDb.getCollection(r);null===a&&(a=A.appDb.addCollection(r)),null==t?(e.FID=n,a.insert(e)):(e=y.copyProperty(e,t),a.update(e))});else if(s.constructor===Object){if(s.LID=y.guid(),n=s.LID,o){A.deleteCascade(r,s);continue}var p=A.getBasedOnGid(r,s);if(t===m&&p&&null!=p){var i=y.getBeChildrenNames(r);if(null!=i&&0<i.length)for(var l=0;l<i.length;l++){var u=A.appDb.getCollection(i[l].name);null!=u&&u.removeWhere({FID:p.LID})}}var c=A.appDb.getCollection(r);null===c&&(c=A.appDb.addCollection(r)),null==p?(s.LID=y.guid(),c.insert(s)):(s=y.copyProperty(s,p),c.update(s)),n=s.LID}else o="D"==s}},w);function w(){}var I=(S.initialize=function(){0<r.metadataPath.length?S.loadJSON(S.parse):0<r.metadataJSON.length?S.parse(r.metadataJSON):console.log("ERROR: metadataJSON is empty. Set the JSON to loginParameters.metadataJSON")},S.loadJSON=function(e){var t=new XMLHttpRequest;t.overrideMimeType("application/json");var a=y.isEmpty(r.metadataPath)?"metadata.json":r.metadataPath;t.open("GET",a,!0),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e(t.responseText)},t.send(null)},S.parse=function(e){if(!y.isEmpty(e)){var t=JSON.parse(e);for(var a in t)if(t.hasOwnProperty(a)){var n=t[a];n.constructor===Object&&S.parseEachBE(n,a)}}},S.parseEachBE=function(e,t){var a={};for(var n in a.attachment=!y.isEmpty(e.attachments)&&e.attachments,a.onConflict=y.isEmpty(e.onConflict)?conflictRule.SERVER_WINS:e.onConflict,a.save=!!y.isEmpty(e.save)||e.save,a.name=t,p.bMeta.push(a),e)if(e.hasOwnProperty(n)){var o=e[n];if(o.constructor===Object){var r={};r.beName=a.name,r.isheader=-1<n.indexOf("_HEADER")||-1<n.indexOf("_HDR"),r.name=n,p.sMeta.push(r);var s=o.field;null!=s&&0<s.length&&s.forEach(function(e){var t={};t.beName=a.name,t.sName=r.name,t.name=e.name,t.isGid=e.isGid,t.isMandatory=e.mandatory,t.sqlType=e.sqlType,p.fMeta.push(t)})}}},S);function S(){}e("cordova/exec/proxy").add("LoginPlugin",a.exports),e("cordova/exec/proxy").add("LoggerPlugin",a.exports),e("cordova/exec/proxy").add("SyncEnginePlugin",a.exports),e("cordova/exec/proxy").add("AttachmentPlugin",a.exports),e("cordova/exec/proxy").add("SettingsPlugin",a.exports),e("cordova/exec/proxy").add("DatabasePlugin",a.exports)});
